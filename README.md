Código indentado e arrumado de um jeito mais visual.
Rian e eu conseguimos arrumar o problema do scanf onde ele só lia a string antes do espaço.
Agora está funcionando.

